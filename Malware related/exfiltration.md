---
title: Data exfiltration
description : "Nice buttons on your page."
---


### Overview <a id="chapter-1"></a>

In the presence of security countermeasures, a malware designed for data exfiltration must do so using a covert channel to achieve its goal. Among existing covert channels stands the domain name system (DNS) protocol. Exfiltration of data via DNS queries is a method of breaching the confidentiality of an organization that is commonly available, hard to detect, and can provide indirect command and control (C2) channels between an attacker and compromised hosts.

### Techniques <a id="chapter-2"></a>
![alt text](Data-Exfiltration.png)

#### VPN over DNS

### Real case abuse<a id="chapter-3"></a>


### Tools <a id="chapter-4"></a>

### Research papers <a id="chapter-5"></a>

[Detection of Malicious and Low Throughput Data
Exfiltration Over the DNS Protocol](https://arxiv.org/pdf/1709.08395.pdf)

### Detection <a id="chapter-6"></a>

To detect DNS exfiltration, evaluation of namequery network traffic is required. The easiest way
to accomplish this is to enable query logging on nameservers; however, the servers can quickly
become overloaded with logging data if they are not sufficiently provisioned to handle this extra
load. Network sensors that can capture DNS traffic could also be used. Implementation of
network sensors is more difficult, but can yield better results as analysis of inbound and
outbound DNS traffic is generally easier.

Correlation of DNS queries to other proxy logs to determine whether the queries were the result
of legitimate service access is also very important. Outbound connection logs, including firewall
and other perimeter control devices, should be monitored in conjunction with DNS queries, and
any DNS query that does not result in a proxied outbound connection request should be
investigated.

### Mitigation <a id="chapter-7"></a>

To prevent DNS exfiltration from a protected network, ensure that DNS queries are not relayed
outside the trusted perimeter. This will prevent any information being leaked via DNS to
untrusted hosts.



### References <a id="chapter-8"></a>

[DNS as a Covert Channel Within Protected
Networks](https://www.researchgate.net/profile/Seth_Bromberger/publication/319492986_DNS_as_a_Covert_Channel_Within_Protected_Networks/links/59aed9e2a6fdcca6542425c5/DNS-as-a-Covert-Channel-Within-Protected-Networks.pdf)
[Detecting DNS Tunneling - SANS Institute](https://www.sans.org/reading-room/whitepapers/dns/detecting-dns-tunneling-34152)